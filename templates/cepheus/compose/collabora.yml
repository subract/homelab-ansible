networks:
  web:

services:
  collabora:
    image: collabora/code
    container_name: collabora
    restart: unless-stopped
    # user: "4011:4011"
    cap_drop:
      - ALL
    cap_add:
      - MKNOD
      - SYS_CHROOT
      - SYS_ADMIN
      - FOWNER
      - CHOWN

    environment:
      aliasgroup1: "https://file.{{ tertiary_domain }}:443"
      extra_params: "--o:ssl.enable=false --o:ssl.termination=true"

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro

    networks:
      - web

    labels:
      traefik.enable: true
      traefik.http.routers.collabora.rule: Host(`collabora.{{ tertiary_domain }}`)
      traefik.http.routers.collabora.tls.certresolver: default
      traefik.http.services.collabora.loadbalancer.server.port: 9980
